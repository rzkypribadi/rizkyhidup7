<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Nayra</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;600&family=Parisienne&display=swap" rel="stylesheet">
    <style>
        :root {
            --royal-purple: #7851A9;
            --metallic-gold: #D4AF37;
            --ruby-red: #E0115F;
            --sapphire-blue: #0F52BA;
            --emerald-green: #50C878;
            --pure-gold: #FFD700;
            --sterling-silver: #C0C0C0;
            --blush-pink: #FF6B6B;
            --diamond: rgba(255,255,255,0.9);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            position: relative;
            color: white;
            perspective: 1000px;
        }

        .luxury-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000, #111);
            z-index: -3;
        }

        .color-wave {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                45deg,
                var(--royal-purple),
                var(--metallic-gold),
                var(--ruby-red),
                var(--sapphire-blue),
                var(--emerald-green),
                var(--pure-gold),
                var(--sterling-silver),
                var(--blush-pink)
            );
            background-size: 800% 800%;
            z-index: -2;
            opacity: 0.3;
            animation: gradientFlow 15s ease infinite;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .diamond-sparkle {
            position: fixed;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 25%);
            z-index: -1;
            animation: sparkle 3s infinite alternate;
        }

        @keyframes sparkle {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }

        .page {
            position: fixed;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: all 1.2s cubic-bezier(0.22, 1, 0.36, 1);
            z-index: 10;
            pointer-events: none;
            transform: translateY(30px);
        }

        .page.active {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }

        .luxury-container {
            text-align: center;
            padding: 50px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 16px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.8);
            max-width: 90%;
            width: 700px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 20px;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.22, 1, 0.36, 1);
            position: relative;
            overflow: hidden;
        }

        .luxury-container:before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                transparent 45%,
                rgba(255, 215, 0, 0.1) 50%,
                transparent 55%
            );
            animation: shine 8s infinite;
            z-index: -1;
        }

        @keyframes shine {
            0% { transform: translate(-30%, -30%) rotate(0deg); }
            100% { transform: translate(30%, 30%) rotate(360deg); }
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5em;
            margin-bottom: 30px;
            font-weight: 700;
            letter-spacing: 1px;
            background: linear-gradient(
                90deg,
                var(--metallic-gold),
                var(--pure-gold),
                var(--royal-purple),
                var(--sterling-silver),
                var(--ruby-red)
            );
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            background-size: 300% 300%;
            animation: gradientTitle 8s ease infinite;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        @keyframes gradientTitle {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.3em;
            line-height: 1.8;
            margin-bottom: 30px;
            font-weight: 300;
        }

        .luxury-btn {
            background: linear-gradient(
                135deg, 
                var(--royal-purple), 
                var(--ruby-red)
            );
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            box-shadow: 0 10px 30px rgba(120, 81, 169, 0.5);
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            animation: btnGlow 3s infinite alternate;
        }

        @keyframes btnGlow {
            0% { box-shadow: 0 0 15px var(--royal-purple); }
            25% { box-shadow: 0 0 20px var(--ruby-red); }
            50% { box-shadow: 0 0 25px var(--pure-gold); }
            75% { box-shadow: 0 0 20px var(--sapphire-blue); }
            100% { box-shadow: 0 0 15px var(--metallic-gold); }
        }

        .luxury-btn:hover {
            transform: translateY(-5px);
            animation: none;
            box-shadow: 0 15px 40px rgba(224, 17, 95, 0.6);
        }

        .luxury-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .luxury-btn:hover:before {
            left: 100%;
        }

        .luxury-next-btn {
            position: fixed;
            right: 40px;
            bottom: 40px;
            background: linear-gradient(135deg, var(--emerald-green), var(--royal-purple));
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            box-shadow: 0 10px 30px rgba(80, 200, 120, 0.4);
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            opacity: 0;
            z-index: 30;
            display: flex;
            align-items: center;
            animation: pulseGlow 3s infinite;
        }

        @keyframes pulseGlow {
            0% { 
                transform: scale(1); 
                box-shadow: 0 0 0 0 rgba(80, 200, 120, 0.5),
                            0 0 10px 0 var(--emerald-green);
            }
            70% { 
                transform: scale(1.05); 
                box-shadow: 0 0 0 15px rgba(80, 200, 120, 0),
                            0 0 20px 5px var(--royal-purple);
            }
            100% { 
                transform: scale(1); 
                box-shadow: 0 0 0 0 rgba(80, 200, 120, 0),
                            0 0 10px 0 var(--sapphire-blue);
            }
        }

        .luxury-next-btn.visible {
            opacity: 1;
        }

        .luxury-balloon {
            position: fixed;
            width: 60px;
            height: 80px;
            z-index: 5;
            filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.4));
            top: -100px;
            animation: floatDown 8s linear forwards;
            transform-style: preserve-3d;
            background: linear-gradient(145deg, var(--royal-purple), var(--ruby-red));
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            overflow: hidden;
            will-change: transform;
        }

        .luxury-balloon:before {
            content: "";
            position: absolute;
            width: 2px;
            height: 80px;
            background: linear-gradient(to bottom, var(--pure-gold), transparent);
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
        }

        .luxury-balloon:after {
            content: "";
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: var(--pure-gold);
            bottom: -92px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 50%;
        }

        @keyframes floatDown {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(120vh) rotate(180deg);
                opacity: 0;
            }
        }

        .luxury-photo-frame {
            position: relative;
            margin: 40px auto;
            width: 300px;
            height: 300px;
            border: 2px solid var(--pure-gold);
            border-radius: 8px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
            overflow: hidden;
            background-size: cover;
            background-position: center;
            transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
            transform-style: preserve-3d;
            animation: frameGlow 4s infinite alternate;
        }

        @keyframes frameGlow {
            0% { box-shadow: 0 0 20px var(--royal-purple); }
            50% { box-shadow: 0 0 30px var(--metallic-gold); }
            100% { box-shadow: 0 0 20px var(--sapphire-blue); }
        }

        .luxury-photo-frame:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(0,0,0,0.3), transparent);
            z-index: 2;
        }

        .luxury-photo-frame:hover {
            transform: scale(1.05) rotateY(5deg);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.8);
        }

        .luxury-confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            opacity: 0;
            z-index: 8;
            animation: confettiFall 4s linear forwards;
            border-radius: 50%;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .luxury-music-control {
            position: fixed;
            left: 20px;
            bottom: 20px;
            background: rgba(120, 81, 169, 0.2);
            color: white;
            border: 1px solid var(--pure-gold);
            padding: 5px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            z-index: 30;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 20px;
            height: 20px;
            backdrop-filter: blur(10px);
            animation: controlPulse 2s infinite;
        }

        @keyframes controlPulse {
            0% { box-shadow: 0 0 5px var(--royal-purple); }
            50% { box-shadow: 0 0 10px var(--metallic-gold); }
            100% { box-shadow: 0 0 5px var(--ruby-red); }
        }

        .luxury-music-control:hover {
            background: rgba(224, 17, 95, 0.3);
            transform: scale(1.1);
        }

        .luxury-progress-container {
            position: fixed;
            left: 50px;
            bottom: 27px;
            width: 150px;
            height: 2px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            z-index: 30;
            display: none;
        }

        .luxury-progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--royal-purple), var(--ruby-red));
            width: 0%;
            transition: width 0.1s linear;
        }

        .luxury-music-control svg {
            width: 12px;
            height: 12px;
        }

        .luxury-input {
            width: 100%;
            padding: 18px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.4s ease;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-family: 'Montserrat', sans-serif;
        }

        .luxury-input:focus {
            outline: none;
            border-color: var(--pure-gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        .luxury-pop-out {
            animation: popOut 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            transform-origin: center;
        }

        @keyframes popOut {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .luxury-glow {
            animation: containerGlow 3s infinite alternate;
        }

        @keyframes containerGlow {
            from {
                box-shadow: 0 0 20px rgba(120, 81, 169, 0.3);
                border-color: rgba(212, 175, 55, 0.3);
            }
            to {
                box-shadow: 0 0 40px rgba(224, 17, 95, 0.6), 0 0 60px rgba(80, 200, 120, 0.4);
                border-color: rgba(255, 215, 0, 0.6);
            }
        }

        .luxury-teddy {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            z-index: 20;
            animation: float 4s infinite ease-in-out;
            filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.4));
        }

        @keyframes float {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-15px); }
        }

        .luxury-short-message {
            font-family: 'Parisienne', cursive;
            font-size: 1.8em;
            color: var(--sterling-silver);
            margin: 25px 0;
            opacity: 0;
            transform: translateY(20px);
            transition: all 1s ease 0.5s;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .page.active .luxury-short-message {
            opacity: 1;
            transform: translateY(0);
        }

        .luxury-emoji {
            position: absolute;
            font-size: 2rem;
            z-index: -1;
            animation: fly linear infinite;
            text-shadow: 0 0 15px var(--diamond);
            opacity: 0.8;
            will-change: transform;
        }

        @keyframes fly {
            0% {
                transform: translate(var(--start-x), var(--start-y));
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translate(var(--end-x), var(--end-y));
                opacity: 0;
            }
        }

        .stopwatch-container {
            margin: 30px auto;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            max-width: 500px;
        }

        .stopwatch-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8em;
            margin-bottom: 15px;
            color: white;
            text-shadow: 2px 2px 4px #ECC8C9;
        }

        .stopwatch-display {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5em;
            margin: 15px 0;
            color: white;
            text-shadow: 2px 2px 4px #B0D6F5;
        }

        .time-unit {
            display: inline-block;
            min-width: 80px;
            text-align: center;
        }

        .time-separator {
            display: inline-block;
            margin: 0 5px;
        }

        /* Puzzle Game Styles */
        .puzzle-container {
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
            position: relative;
        }

        .puzzle-image {
            width: 100%;
            height: auto;
            border: 2px solid var(--pure-gold);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transition: all 0.5s ease;
        }

        .puzzle-pieces-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin: 20px 0;
            overflow: hidden;
            border: 2px solid var(--metallic-gold);
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .puzzle-piece {
            position: absolute;
            background-size: cover;
            cursor: move;
            z-index: 10;
            border: 2px solid var(--metallic-gold);
            box-sizing: border-box;
            transition: transform 0.3s ease, left 0.3s ease, top 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            touch-action: none;
        }

        .puzzle-piece:hover {
            transform: scale(1.05);
            z-index: 20;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }

        .puzzle-piece.correct {
            border: 2px solid var(--emerald-green);
            box-shadow: 0 0 15px var(--emerald-green);
            cursor: default;
            animation: correctGlow 1.5s infinite alternate;
        }

        @keyframes correctGlow {
            0% { box-shadow: 0 0 10px var(--emerald-green); }
            100% { box-shadow: 0 0 20px var(--emerald-green), 0 0 30px var(--emerald-green); }
        }

        .puzzle-help-btn {
            background: linear-gradient(135deg, var(--sapphire-blue), var(--royal-purple));
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .puzzle-help-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(15, 82, 186, 0.4);
        }

        .puzzle-help-btn:after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .puzzle-help-btn:hover:after {
            left: 100%;
        }

        .puzzle-complete {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .puzzle-complete.active {
            opacity: 1;
            pointer-events: auto;
        }

        .puzzle-complete h2 {
            font-size: 3em;
            color: var(--pure-gold);
            margin-bottom: 20px;
            text-align: center;
        }

        .puzzle-complete p {
            font-size: 1.5em;
            color: white;
            text-align: center;
            max-width: 80%;
        }

        .puzzle-next-btn {
            background: linear-gradient(135deg, var(--emerald-green), var(--royal-purple));
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
        }

        .puzzle-next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(80, 200, 120, 0.5);
        }

        /* Word Puzzle Styles */
        .word-puzzle-container {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
        }

        .word-puzzle-display {
            min-height: 150px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--pure-gold);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .word-puzzle-slot {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            font-size: 1.5em;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 5px;
            position: relative;
        }

        .word-puzzle-slot.correct {
            background: var(--emerald-green);
            color: white;
        }

        .word-puzzle-slot.incorrect {
            background: var(--ruby-red);
            color: white;
        }

        .word-puzzle-letters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .word-puzzle-letter {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            font-size: 1.5em;
            background: linear-gradient(135deg, var(--royal-purple), var(--sapphire-blue));
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .word-puzzle-letter:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .word-puzzle-letter.selected {
            background: var(--metallic-gold);
            color: black;
            transform: scale(1.1);
        }

        .word-puzzle-letter.used {
            opacity: 0.5;
            pointer-events: none;
        }

        .word-puzzle-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .word-puzzle-clear-btn {
            background: linear-gradient(135deg, var(--ruby-red), var(--blush-pink));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .word-puzzle-clear-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(224, 17, 95, 0.4);
        }

        /* Birthday Card Creator Styles */
        .card-creator-container {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
        }

        .card-preview {
            width: 100%;
            min-height: 300px;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            border-radius: 10px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--pure-gold);
        }

        .card-element {
            position: absolute;
            cursor: move;
            user-select: none;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card-element.selected {
            outline: 2px dashed var(--ruby-red);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            z-index: 10;
        }

        .card-element:hover {
            transform: scale(1.03);
        }

        .card-elements {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .card-element-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--pure-gold);
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card-element-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
        }

        .card-element-btn img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .card-message-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--pure-gold);
            border-radius: 5px;
            color: white;
            font-size: 1em;
            transition: all 0.3s;
        }

        .card-message-input:focus {
            outline: none;
            border-color: var(--metallic-gold);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        .card-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .card-control-btn {
            background: linear-gradient(135deg, var(--royal-purple), var(--ruby-red));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .card-control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(224, 17, 95, 0.4);
        }

        .card-final {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .card-final.active {
            opacity: 1;
            pointer-events: auto;
        }

        .card-final-image {
            max-width: 90%;
            max-height: 70vh;
            border: 3px solid var(--pure-gold);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.5s;
            cursor: pointer;
        }

        .card-final.active .card-final-image {
            transform: scale(1);
        }

        .card-final-message {
            font-size: 1.5em;
            color: white;
            margin: 20px 0;
            text-align: center;
            max-width: 80%;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s 0.3s;
        }

        .card-final.active .card-final-message {
            opacity: 1;
            transform: translateY(0);
        }

        .card-final-btn {
            background: linear-gradient(135deg, var(--emerald-green), var(--royal-purple));
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1.1em;
            transition: all 0.3s;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s 0.6s;
        }

        .card-final.active .card-final-btn {
            opacity: 1;
            transform: translateY(0);
        }

        .card-final-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(80, 200, 120, 0.5);
        }

        .card-confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--pure-gold);
            opacity: 0;
            z-index: 5;
        }

        /* Special Effects for Card Creation */
        .card-sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--pure-gold);
            border-radius: 50%;
            pointer-events: none;
            z-index: 15;
            animation: sparklePop 0.8s ease-out forwards;
        }

        @keyframes sparklePop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.5);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 0;
            }
        }

        .card-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            background: radial-gradient(circle at center, rgba(255, 215, 0, 0.3), transparent 70%);
            pointer-events: none;
            z-index: 5;
            animation: cardGlow 2s infinite alternate;
        }

        @keyframes cardGlow {
            0% {
                opacity: 0.3;
            }
            100% {
                opacity: 0.7;
            }
        }

        /* Photo Pages */
        .photo-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Puzzle Animation */
        @keyframes scatterPieces {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }
            100% {
                transform: translate(var(--end-x), var(--end-y)) rotate(var(--rotate));
            }
        }

        /* Particle effect for puzzle */
        .particle {
            position: fixed;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 30;
        }

        /* Enhanced Confetti Effect */
        .enhanced-confetti {
            position: fixed;
            width: 15px;
            height: 15px;
            opacity: 0;
            z-index: 8;
            animation: enhancedConfettiFall 5s linear forwards;
        }

        @keyframes enhancedConfettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg) scale(0.5);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg) scale(1.5);
                opacity: 0;
            }
        }

        /* Photo frame enhancements */
        .photo-frame-border {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 3px solid var(--metallic-gold);
            border-radius: 12px;
            z-index: 1;
            pointer-events: none;
        }

        .photo-frame-inner-border {
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 6px;
            z-index: 1;
            pointer-events: none;
        }

        /* Puzzle piece mini-frame */
        .puzzle-piece-frame {
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 1px solid rgba(255, 215, 0, 0.5);
            border-radius: 2px;
            z-index: 1;
            pointer-events: none;
        }

        /* Hide puzzle frames on page 5 */
        #puzzleContainer2 .puzzle-frame {
            display: none;
        }

        @media (max-width: 768px) {
            .luxury-container {
                padding: 30px;
                width: 95%;
            }
            
            h1 {
                font-size: 2.5em;
            }
            
            p, .luxury-short-message {
                font-size: 1.2em;
            }
            
            .luxury-photo-frame {
                width: 250px;
                height: 250px;
            }
            
            .luxury-next-btn {
                right: 20px;
                bottom: 20px;
                padding: 12px 20px;
                font-size: 0.9em;
            }

            .luxury-music-control {
                left: 15px;
                bottom: 15px;
                width: 18px;
                height: 18px;
            }
            
            .luxury-progress-container {
                left: 40px;
                bottom: 22px;
                width: 120px;
            }

            .luxury-emoji {
                font-size: 1.5rem;
            }

            .stopwatch-title {
                font-size: 1.5em;
            }

            .stopwatch-display {
                font-size: 2em;
            }

            .time-unit {
                min-width: 60px;
            }

            .puzzle-complete h2 {
                font-size: 2em;
            }

            .puzzle-complete p {
                font-size: 1.2em;
            }

            .word-puzzle-slot, .word-puzzle-letter {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 1.2em;
            }

            .card-preview {
                min-height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="luxury-bg"></div>
    <div class="color-wave"></div>
    <div class="diamond-sparkle"></div>
    
    <!-- Page 1 - Initial Page -->
    <div class="page active" id="page1">
        <div class="luxury-container">
            <h1>SELAMAT DATANG!!</h1>
            <p>SELAMAT DATANG DI PAGE AWAL WEBSITE BIRTHDAY NAYRA, SILAHKAN MASUKAN NAMA UNTUK DI UCAPKAN </p>
            <button class="luxury-btn" id="startBtn">Selanjutnya</button>
            
            <div style="margin-top: 30px;">
                <input type="text" class="luxury-input" id="nameInput" placeholder="Ketik Nama...">
            </div>
        </div>
    </div>

    <!-- Page 2 - Birthday Message -->
    <div class="page" id="page2">
        <div class="luxury-container">
            <h1 id="personalizedGreeting">HAPPY BIRTHDAY</h1>
            <p>SEMOGA HARI ISTIMEWA INI JADI AWAL DARI SEGALA HAL BAIK YANG KAMU HARAPKAN, PANJANG UMUR, SEHAT SELALU, REZEKI LANCAR, DAN SEGALA HARAPAN BISA TERCAPAI DI USIA YANG BARU.</p>
            <div class="luxury-short-message">Jadilah versi terbaik dari dirimu sendiri, bukan tiruan dari orang lain</div>
        </div>
    </div>

    <!-- Page 3 - Stopwatch Page -->
    <div class="page" id="page3">
        <div class="luxury-container">
            <div class="stopwatch-container">
                <div class="stopwatch-title">Nayra Telah Menjalani Hari Selama</div>
                <div class="stopwatch-display">
                    <div class="time-unit" id="years">0</div>
                    <div class="time-separator">Tahun</div>
                    <div class="time-unit" id="months">0</div>
                    <div class="time-separator">Bulan</div>
                    <div class="time-unit" id="days">0</div>
                    <div class="time-separator">Hari</div>
                </div>
                <div class="stopwatch-display">
                    <div class="time-unit" id="hours">0</div>
                    <div class="time-separator">Jam</div>
                    <div class="time-unit" id="minutes">0</div>
                    <div class="time-separator">Menit</div>
                    <div class="time-unit" id="seconds">0</div>
                    <div class="time-separator">Detik</div>
                </div>
            </div>
            <div class="luxury-short-message">Waktu Tidak Bisa Di Ulang,Jadi Gunakan Setiap Detiknya Untuk Mengejar Mimpi. ~Monkey D.Luffy</div>
        </div>
    </div>

    <!-- Page 4 - Puzzle Game 1 -->
    <div class="page" id="page4">
        <div class="luxury-container">
            <h1>Puzzle</h1>
            <p>Klik Susun Puzzle, Untuk Menyusun Puzzle</p>
            <div class="puzzle-container">
                <div class="puzzle-pieces-container" id="puzzleContainer1"></div>
                <button class="puzzle-help-btn" id="helpBtn1">SUSUN PUZZLE</button>
            </div>
            <div class="luxury-short-message">Susun Puzzle</div>
            
            <div class="puzzle-complete" id="puzzleComplete1">
                <h2>Puzzle Berhasil Di Selesaikan!</h2>
                <p>Selamat!,Kamu Telah Menyelesaikan Puzzle</p>
                <button class="puzzle-next-btn" id="nextPuzzleBtn1">Selanjutnya</button>
            </div>
        </div>
    </div>

    <!-- Page 5 - Puzzle Game 2 -->
    <div class="page" id="page5">
        <div class="luxury-container">
            <h1>Puzzle</h1>
            <p>Klik Susun Puzzle, Untuk Menyusun Puzzle </p>
            <div class="puzzle-container">
                <div class="puzzle-pieces-container" id="puzzleContainer2"></div>
                <button class="puzzle-help-btn" id="helpBtn2">SUSUN PUZZLE</button>
            </div>
            <div class="luxury-short-message">Susun Puzzle</div>
            
            <div class="puzzle-complete" id="puzzleComplete2">
                <h2>Puzzle Berhasil Di Selesaikan!</h2>
                <p>Selamat!,Kamu Telah Menyelesaikan Puzzle</p>
                <button class="puzzle-next-btn" id="nextPuzzleBtn2">Selanjutnya</button>
            </div>
        </div>
    </div>

    <!-- Page 6 - Puzzle Game 3 (New Puzzle) -->
    <div class="page" id="page6">
        <div class="luxury-container">
            <h1>Puzzle</h1>
            <p>Klik Susun Puzzle,Untuk Menyusun Puzzle</p>
            <div class="puzzle-container">
                <div class="puzzle-pieces-container" id="puzzleContainer3"></div>
                <button class="puzzle-help-btn" id="helpBtn3">SUSUN PUZZLE</button>
            </div>
            <div class="luxury-short-message">Susun Puzzle</div>
            
            <div class="puzzle-complete" id="puzzleComplete3">
                <h2>Puzzle Berhasil Di Selesaikan!</h2>
                <p>Selamat!,Kamu Telah Menyelesaikan Puzzle</p>
                <button class="puzzle-next-btn" id="nextPuzzleBtn3">Selanjutnya</button>
            </div>
        </div>
    </div>

    <!-- Page 7 - Word Puzzle -->
    <div class="page" id="page7">
        <div class="luxury-container">
            <h1>Puzzle</h1>
            <p>Susun Puzzle Kata </p>
            <div class="word-puzzle-container">
                <div class="word-puzzle-display" id="wordDisplay"></div>
                <div class="word-puzzle-letters" id="wordLetters"></div>
                <div class="word-puzzle-controls">
                    <button class="word-puzzle-clear-btn" id="wordClearBtn">Hapus Jawaban</button>
                    <button class="puzzle-help-btn" id="wordHelpBtn">Bantuan</button>
                </div>
            </div>
            <div class="luxury-short-message">Susun Puzzle</div>
            
            <div class="puzzle-complete" id="wordPuzzleComplete">
                <h2>Puzzle Berhasil Di Selesaikan!</h2>
                <p>Selamat!,Kamu Telah Menyelesaikan Puzzle Kata</p>
                <button class="puzzle-next-btn" id="nextWordPuzzleBtn">Selanjutnya</button>
            </div>
        </div>
    </div>

    <!-- Page 8 - Birthday Card Creator -->
    <div class="page" id="page8">
        <div class="luxury-container">
            <h1>Buat Kartu Spesial</h1>
            <p>Design Dan Buat Kartu Kamu Sendiri</p>
            
            <div class="card-creator-container">
                <div class="card-preview" id="cardPreview">
                    <div class="card-glow"></div>
                </div>
                
                <div class="card-elements">
                    <div class="card-element-btn" data-type="balloon">
                        <img src="https://cdn.pixabay.com/photo/2017/01/31/23/42/balloons-2028478_960_720.png" alt="Balloon">
                    </div>
                    <div class="card-element-btn" data-type="cake">
                        <img src="https://cdn.pixabay.com/photo/2017/01/11/11/33/cake-1971552_960_720.png" alt="Cake">
                    </div>
                    <div class="card-element-btn" data-type="gift">
                        <img src="https://cdn.pixabay.com/photo/2017/01/31/23/36/gift-2028727_960_720.png" alt="Gift">
                    </div>
                    <div class="card-element-btn" data-type="hat">
                        <img src="https://cdn.pixabay.com/photo/2017/01/31/23/36/party-2028725_960_720.png" alt="Party Hat">
                    </div>
                    <div class="card-element-btn" data-type="confetti">
                        <img src="https://cdn.pixabay.com/photo/2017/01/31/23/36/confetti-2028726_960_720.png" alt="Confetti">
                    </div>
                </div>
                
                <input type="text" class="card-message-input" id="cardMessage" placeholder="Buat Teks...">
                
                <div class="card-controls">
                    <button class="card-control-btn" id="clearCardBtn">Hapus Semua Efek</button>
                    <button class="card-control-btn" id="finishCardBtn">Selesai</button>
                </div>
            </div>
            
            <div class="luxury-short-message">Kartu Yang Hanya Ada Di Website Ini</div>
        </div>
    </div>

    <!-- Page 9 - Photo 1 -->
    <div class="page photo-page" id="page9">
        <div class="luxury-container">
            <h1>HAPPY BIRTHDAY</h1>
            <div class="luxury-photo-frame" id="photo1" style="background-image: url('https://files.catbox.moe/qeyjwe.webp')">
                <div class="photo-frame-border"></div>
                <div class="photo-frame-inner-border"></div>
            </div>
            <p>Semoga Panjang Umur, Sehat Selalu, Dan Rezeki Makin Lancar.</p>
            <div class="luxury-short-message">Happy Birthday</div>
            <img src="https://cdn.pixabay.com/photo/2020/05/11/15/06/teddy-bear-5157893_960_720.png" alt="VIP Teddy" class="luxury-teddy">
        </div>
    </div>

    <!-- Page 10 - Photo 2 -->
    <div class="page photo-page" id="page10">
        <div class="luxury-container">
            <h1>HAPPY BIRTHDAY</h1>
            <div class="luxury-photo-frame" id="photo2" style="background-image: url('https://files.catbox.moe/auwnh9.webp')">
                <div class="photo-frame-border"></div>
                <div class="photo-frame-inner-border"></div>
            </div>
            <p>Semoga Di Usiamu Yang Baru Membawa Lebih Banyak Berkah Dan Kebahagiaan.</p>
            <div class="luxury-short-message">Happy Birthday</div>
            <img src="https://cdn.pixabay.com/photo/2020/05/11/15/06/teddy-bear-5157893_960_720.png" alt="VIP Teddy" class="luxury-teddy">
        </div>
    </div>

    <!-- Page 11 - Photo 3 -->
    <div class="page photo-page" id="page11">
        <div class="luxury-container">
            <h1>TERIMA KASIH</h1>
            <div class="luxury-photo-frame" id="photo3" style="background-image: url('https://files.catbox.moe/chouth.jpg')">
                <div class="photo-frame-border"></div>
                <div class="photo-frame-inner-border"></div>
            </div>
            <p>Terima Kasih Sudah Melihat Website Ini..</p>
            <div class="luxury-short-message">Thank You</div>
            <img src="https://cdn.pixabay.com/photo/2020/05/11/15/06/teddy-bear-5157893_960_720.png" alt="VIP Teddy" class="luxury-teddy">
        </div>
    </div>

    <!-- Page 12 - Final Page -->
    <div class="page" id="page12">
        <div class="luxury-container luxury-glow">
            <h1 id="finalGreeting"></h1>
            <p></p>
            <div class="luxury-short-message">Until we celebrate again in PREMIUM style</div>
            <button class="luxury-btn" id="restartBtn"></button>
        </div>
    </div>

    <!-- Card Final Display -->
    <div class="card-final" id="cardFinal">
        <img class="card-final-image" id="cardFinalImage" src="" alt="VIP Birthday Card">
        <p class="card-final-message">Tekan kartu untuk mendownload! Terima kasih telah membuat kartu spesial untuk Nayra!</p>
        <button class="card-final-btn" id="closeCardBtn">Selanjutnya</button>
    </div>

    <button class="luxury-next-btn" id="nextBtn">
        <span>Selanjutnya</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-left: 10px;">
            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>

    <button class="luxury-music-control" id="musicControl">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 20L19 4M12 20V12M5 20V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="musicIcon"/>
        </svg>
    </button>

    <div class="luxury-progress-container" id="progressContainer">
        <div class="luxury-progress-bar" id="progressBar"></div>
    </div>

    <audio id="bgMusic" loop>
        <source src="https://files.catbox.moe/75ooy9.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // VIP configuration
            const config = {
                balloons: 15,
                confetti: 30,
                emojis: ['üõ©Ô∏è', 'üöÄ', 'üê£', '‚òÑÔ∏è', 'üêÖ', 'üêã', 'üíé', '‚ú®', 'üëë', 'ü™ê', 'üåå', 'üéá'],
                animations: {
                    balloonSpeed: 8,
                    confettiSpeed: 4,
                    emojiSpeed: 15
                }
            };
            
            // Set VIP assets
            const assets = {
                puzzle1: 'https://files.catbox.moe/jsmsy6.jpg',
                puzzle2: 'https://files.catbox.moe/8ejhq7.jpg',
                puzzle3: 'https://files.catbox.moe/h230gk.jpg',
                photo1: 'https://files.catbox.moe/qeyjwe.webp',
                photo2: 'https://files.catbox.moe/auwnh9.webp',
                photo3: 'https://files.catbox.moe/chouth.jpg',
                music: 'https://files.catbox.moe/75ooy9.mp3',
                name: ''
            };
            
            // Audio setup
            const bgMusic = document.getElementById('bgMusic');
            bgMusic.src = assets.music;
            let isMusicPlaying = false;
            
            // DOM elements
            const musicControl = document.getElementById('musicControl');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const nameInput = document.getElementById('nameInput');
            const personalizedGreeting = document.getElementById('personalizedGreeting');
            const finalGreeting = document.getElementById('finalGreeting');
            
            // Set name if provided in URL
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('name')) {
                nameInput.value = urlParams.get('name');
            }
            
            // Stopwatch functionality
            function updateStopwatch() {
                const startDate = new Date('2012-06-16T00:00:00'); // 16 Juni 2012
                const now = new Date();
                
                // Hitung usia penuh (akan 12 sampai 16 Juni 2024, lalu 13 setelahnya)
                let years = now.getFullYear() - startDate.getFullYear();
                const monthDiff = now.getMonth() - startDate.getMonth();
                
                // Jika bulan sekarang sebelum Juni, atau bulan sama tapi tanggal sebelum 16
                if (monthDiff < 0 || (monthDiff === 0 && now.getDate() < startDate.getDate())) {
                    years--;
                }
                document.getElementById('years').textContent = years;
                
                // Hitung bulan sejak ulang tahun terakhir (0-11)
                let months;
                if (now.getMonth() > startDate.getMonth() || 
                   (now.getMonth() === startDate.getMonth() && now.getDate() >= startDate.getDate())) {
                    months = now.getMonth() - startDate.getMonth();
                } else {
                    months = 12 - (startDate.getMonth() - now.getMonth());
                }
                
                // Koreksi jika tanggal sekarang sebelum tanggal ulang tahun di bulan yang sama
                if (now.getDate() < startDate.getDate()) {
                    months--;
                    if (months < 0) months = 11;
                }
                document.getElementById('months').textContent = months;
                
                // Hitung hari sejak ulang tahun terakhir di bulan sebelumnya
                let lastAnniv = new Date(now.getFullYear(), now.getMonth(), startDate.getDate());
                if (now.getDate() < startDate.getDate()) {
                    lastAnniv = new Date(now.getFullYear(), now.getMonth() - 1, startDate.getDate());
                }
                
                const days = Math.floor((now - lastAnniv) / (1000 * 60 * 60 * 24));
                document.getElementById('days').textContent = days;
                
                // Hitung jam, menit, detik saat ini
                const hours = now.getHours();
                const minutes = now.getMinutes();
                const seconds = now.getSeconds();
                
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
                
                // Update setiap detik
                setTimeout(updateStopwatch, 1000);
            }

            // Start the stopwatch
            updateStopwatch();
            
            // Create luxury square balloons
            function createLuxuryBalloons() {
                const symbols = ['üéÅ', 'üéÄ', 'üíé', '‚ú®', 'üèÜ', '‚ú¶', 'üëë', 'üíç', 'üïØÔ∏è', 'üéä','üå†','üõ©Ô∏è','üêÖ','üêã','ü™ê','üåå'];
                
                for (let i = 0; i < config.balloons; i++) {
                    setTimeout(() => {
                        const balloon = document.createElement('div');
                        balloon.className = 'luxury-balloon';
                        balloon.style.left = Math.random() * 100 + 'vw';
                        balloon.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                        
                        // Random size and animation
                        const size = 50 + Math.random() * 50;
                        balloon.style.width = size + 'px';
                        balloon.style.height = size * 1.2 + 'px';
                        
                        // Random color
                        const colors = ['var(--royal-purple)', 'var(--metallic-gold)', 'var(--ruby-red)', 'var(--sapphire-blue)'];
                        balloon.style.background = `linear-gradient(145deg, ${colors[Math.floor(Math.random() * colors.length)]}, ${colors[Math.floor(Math.random() * colors.length)]})`;
                        
                        const duration = 4 + Math.random() * config.animations.balloonSpeed;
                        balloon.style.animation = `floatDown ${duration}s linear forwards`;
                        
                        document.body.appendChild(balloon);
                        
                        // Remove balloon after animation
                        setTimeout(() => {
                            balloon.remove();
                        }, duration * 1000);
                    }, i * 1000);
                }
                
                // Continuous balloon creation
                setTimeout(createLuxuryBalloons, 15000);
            }
            
            // Create luxury flying emojis
            function createLuxuryEmojis() {
                const emoji = config.emojis[Math.floor(Math.random() * config.emojis.length)];
                const flyingEmoji = document.createElement('div');
                flyingEmoji.className = 'luxury-emoji';
                flyingEmoji.textContent = emoji;
                
                // Random start position (outside viewport)
                const startSide = Math.floor(Math.random() * 4); // 0: top, 1: right, 2: bottom, 3: left
                let startX, startY;
                
                if (startSide === 0) { // top
                    startX = Math.random() * 100;
                    startY = -10;
                } else if (startSide === 1) { // right
                    startX = 110;
                    startY = Math.random() * 100;
                } else if (startSide === 2) { // bottom
                    startX = Math.random() * 100;
                    startY = 110;
                } else { // left
                    startX = -10;
                    startY = Math.random() * 100;
                }
                
                // Random end position (opposite side)
                let endX, endY;
                if (startSide === 0 || startSide === 2) { // top or bottom
                    endX = Math.random() * 100;
                    endY = startSide === 0 ? 110 : -10;
                } else { // left or right
                    endX = startSide === 1 ? -10 : 110;
                    endY = Math.random() * 100;
                }
                
                flyingEmoji.style.setProperty('--start-x', `${startX}vw`);
                flyingEmoji.style.setProperty('--start-y', `${startY}vh`);
                flyingEmoji.style.setProperty('--end-x', `${endX}vw`);
                flyingEmoji.style.setProperty('--end-y', `${endY}vh`);
                
                // Random size and speed
                const size = 1 + Math.random() * 3;
                flyingEmoji.style.fontSize = `${size}rem`;
                
                const duration = 5 + Math.random() * config.animations.emojiSpeed;
                flyingEmoji.style.animationDuration = `${duration}s`;
                
                document.body.appendChild(flyingEmoji);
                
                // Remove emoji after animation
                setTimeout(() => {
                    flyingEmoji.remove();
                }, duration * 1000);
                
                // Create next emoji with random delay
                setTimeout(createLuxuryEmojis, 300 + Math.random() * 1200);
            }
            
            function createLuxuryConfetti() {
                for (let i = 0; i < config.confetti; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'luxury-confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        
                        // Random shape (square or circle)
                        if (Math.random() > 0.5) {
                            confetti.style.borderRadius = '4px';
                            confetti.style.width = (10 + Math.random() * 10) + 'px';
                            confetti.style.height = (10 + Math.random() * 10) + 'px';
                        } else {
                            confetti.style.borderRadius = '50%';
                            const size = 8 + Math.random() * 12;
                            confetti.style.width = size + 'px';
                            confetti.style.height = size + 'px';
                        }
                        
                        // Random color
                        const colors = ['var(--royal-purple)', 'var(--metallic-gold)', 'var(--ruby-red)', 'var(--sapphire-blue)', 'var(--emerald-green)', 'var(--pure-gold)'];
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                        
                        const duration = 2 + Math.random() * config.animations.confettiSpeed;
                        confetti.style.animation = `confettiFall ${duration}s linear forwards`;
                        
                        document.body.appendChild(confetti);
                        
                        // Remove confetti after animation
                        setTimeout(() => {
                            confetti.remove();
                        }, duration * 1000);
                    }, i * 200);
                }
            }
            
            // Enhanced confetti effect
            function createEnhancedConfetti() {
                const colors = ['var(--royal-purple)', 'var(--metallic-gold)', 'var(--ruby-red)', 'var(--sapphire-blue)', 'var(--emerald-green)', 'var(--pure-gold)'];
                const shapes = ['circle', 'square', 'triangle'];
                
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'enhanced-confetti';
                    
                    // Random position
                    confetti.style.left = Math.random() * 100 + 'vw';
                    
                    // Random color
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.backgroundColor = color;
                    
                    // Random shape
                    const shape = shapes[Math.floor(Math.random() * shapes.length)];
                    if (shape === 'triangle') {
                        confetti.style.width = '0';
                        confetti.style.height = '0';
                        confetti.style.borderLeft = '8px solid transparent';
                        confetti.style.borderRight = '8px solid transparent';
                        confetti.style.borderBottom = `16px solid ${color}`;
                        confetti.style.backgroundColor = 'transparent';
                    } else {
                        confetti.style.width = '15px';
                        confetti.style.height = '15px';
                        confetti.style.borderRadius = shape === 'circle' ? '50%' : '0';
                    }
                    
                    // Random animation duration and delay
                    const duration = 3 + Math.random() * 3;
                    const delay = Math.random() * 2;
                    confetti.style.animation = `enhancedConfettiFall ${duration}s linear ${delay}s forwards`;
                    
                    document.body.appendChild(confetti);
                    
                    // Remove after animation
                    setTimeout(() => {
                        confetti.remove();
                    }, (duration + delay) * 1000);
                }
            }
            
            // Puzzle Game 1 - Image Puzzle
            function setupPuzzleGame1() {
                const puzzleContainer = document.getElementById('puzzleContainer1');
                const helpBtn = document.getElementById('helpBtn1');
                const puzzleComplete = document.getElementById('puzzleComplete1');
                const nextPuzzleBtn = document.getElementById('nextPuzzleBtn1');
                
                const imageUrl = assets.puzzle1;
                const rows = 4;
                const cols = 4;
                const pieceCount = rows * cols;
                let pieces = [];
                let correctPieces = 0;
                
                // Create puzzle pieces
                function createPuzzle() {
                    puzzleContainer.innerHTML = '';
                    pieces = [];
                    correctPieces = 0;
                    
                    // Create puzzle pieces
                    for (let i = 0; i < pieceCount; i++) {
                        const piece = document.createElement('div');
                        piece.className = 'puzzle-piece';
                        piece.dataset.index = i;
                        
                        // Add border to all pieces
                        piece.style.border = '2px solid var(--metallic-gold)';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Add mini frame to each piece
                        const pieceFrame = document.createElement('div');
                        pieceFrame.className = 'puzzle-piece-frame';
                        piece.appendChild(pieceFrame);
                        
                        // Calculate position in grid
                        const row = Math.floor(i / cols);
                        const col = i % cols;
                        
                        // Set background position
                        piece.style.backgroundImage = `url(${imageUrl})`;
                        piece.style.backgroundSize = `${cols * 100}% ${rows * 100}%`;
                        piece.style.backgroundPosition = `${(col / (cols - 1)) * 100}% ${(row / (rows - 1)) * 100}%`;
                        
                        // Set size
                        const containerWidth = puzzleContainer.offsetWidth;
                        const pieceWidth = containerWidth / cols;
                        piece.style.width = `${pieceWidth}px`;
                        piece.style.height = `${pieceWidth}px`;
                        
                        // Store correct position
                        piece.dataset.correctX = col * pieceWidth;
                        piece.dataset.correctY = row * pieceWidth;
                        
                        // Set random position around the container (split left and right)
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides
                        let angle, distance;
                        if (i % 2 === 0) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                        }
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance;
                        
                        piece.style.left = `${x}px`;
                        piece.style.top = `${y}px`;
                        
                        // Make draggable with touch support
                        makeDraggable(piece);
                        
                        puzzleContainer.appendChild(piece);
                        pieces.push(piece);
                    }
                    
                    // Show full image first, then scramble after 1 second
                    setTimeout(() => {
                        scramblePuzzle();
                    }, 1000);
                }
                
                // Scramble puzzle pieces
                function scramblePuzzle() {
                    pieces.forEach(piece => {
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides
                        let angle, distance;
                        if (Math.random() > 0.5) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                        }
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance;
                        
                        piece.style.left = `${x}px`;
                        piece.style.top = `${y}px`;
                        piece.classList.remove('correct');
                    });
                }
                
                // Make puzzle pieces draggable with touch support
                function makeDraggable(piece) {
                    let offsetX, offsetY;
                    let isDragging = false;
                    
                    // Mouse events
                    piece.addEventListener('mousedown', startDrag);
                    
                    // Touch events
                    piece.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        const mouseEvent = new MouseEvent('mousedown', {
                            clientX: touch.clientX,
                            clientY: touch.clientY
                        });
                        piece.dispatchEvent(mouseEvent);
                    }, {passive: false});
                    
                    function startDrag(e) {
                        e.preventDefault();
                        isDragging = true;
                        
                        // Get initial position
                        const rect = piece.getBoundingClientRect();
                        if (e.type === 'mousedown') {
                            offsetX = e.clientX - rect.left;
                            offsetY = e.clientY - rect.top;
                        } else {
                            offsetX = e.touches[0].clientX - rect.left;
                            offsetY = e.touches[0].clientY - rect.top;
                        }
                        
                        // Bring to front
                        piece.style.zIndex = '20';
                        piece.style.transform = 'scale(1.1)';
                        piece.style.boxShadow = '0 0 20px var(--pure-gold)';
                        
                        // Mouse move
                        document.addEventListener('mousemove', drag);
                        
                        // Touch move
                        document.addEventListener('touchmove', function(e) {
                            e.preventDefault();
                            const touch = e.touches[0];
                            const mouseEvent = new MouseEvent('mousemove', {
                                clientX: touch.clientX,
                                clientY: touch.clientY
                            });
                            drag(mouseEvent);
                        }, {passive: false});
                        
                        // Mouse up
                        document.addEventListener('mouseup', endDrag);
                        
                        // Touch end
                        document.addEventListener('touchend', function(e) {
                            const mouseEvent = new MouseEvent('mouseup');
                            endDrag(mouseEvent);
                        });
                    }
                    
                    function drag(e) {
                        if (!isDragging) return;
                        
                        const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                        const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                        
                        piece.style.left = `${clientX - offsetX}px`;
                        piece.style.top = `${clientY - offsetY}px`;
                    }
                    
                    function endDrag() {
                        if (!isDragging) return;
                        isDragging = false;
                        
                        // Reset appearance
                        piece.style.transform = '';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Check if piece is in correct position
                        const pieceRect = piece.getBoundingClientRect();
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        
                        const pieceCenterX = pieceRect.left + pieceRect.width / 2 - containerRect.left;
                        const pieceCenterY = pieceRect.top + pieceRect.height / 2 - containerRect.top;
                        
                        const distance = Math.sqrt(
                            Math.pow(pieceCenterX - correctX, 2) + 
                            Math.pow(pieceCenterY - correctY, 2)
                        );
                        
                        if (distance < 30) { // Close enough to be correct
                            piece.style.left = `${correctX}px`;
                            piece.style.top = `${correctY}px`;
                            piece.classList.add('correct');
                            piece.style.zIndex = '15';
                            
                            // Add particle effect
                            createParticles(pieceRect.left + pieceRect.width/2, pieceRect.top + pieceRect.height/2);
                            
                            if (!piece.dataset.counted) {
                                piece.dataset.counted = 'true';
                                correctPieces++;
                                
                                if (correctPieces === pieceCount) {
                                    // Puzzle complete
                                    setTimeout(() => {
                                        puzzleComplete.classList.add('active');
                                        createEnhancedConfetti();
                                    }, 500);
                                }
                            }
                        }
                        
                        document.removeEventListener('mousemove', drag);
                        document.removeEventListener('touchmove', drag);
                        document.removeEventListener('mouseup', endDrag);
                        document.removeEventListener('touchend', endDrag);
                    }
                }
                
                // Create particles effect
                function createParticles(x, y) {
                    const colors = ['var(--pure-gold)', 'var(--ruby-red)', 'var(--emerald-green)', 'var(--sapphire-blue)'];
                    
                    for (let i = 0; i < 15; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.position = 'fixed';
                        particle.style.width = '8px';
                        particle.style.height = '8px';
                        particle.style.borderRadius = '50%';
                        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        particle.style.left = `${x}px`;
                        particle.style.top = `${y}px`;
                        particle.style.pointerEvents = 'none';
                        particle.style.zIndex = '30';
                        
                        document.body.appendChild(particle);
                        
                        // Animate
                        const angle = Math.random() * Math.PI * 2;
                        const distance = 20 + Math.random() * 50;
                        const duration = 0.5 + Math.random() * 0.5;
                        
                        const animation = particle.animate([
                            { 
                                transform: 'translate(0, 0) scale(1)',
                                opacity: 1 
                            },
                            { 
                                transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(0)`,
                                opacity: 0 
                            }
                        ], {
                            duration: duration * 1000,
                            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                        });
                        
                        animation.onfinish = () => particle.remove();
                    }
                }
                
                // Help button - solve one piece
                helpBtn.addEventListener('click', function() {
                    const unsolvedPieces = pieces.filter(p => !p.classList.contains('correct'));
                    if (unsolvedPieces.length > 0) {
                        const randomIndex = Math.floor(Math.random() * unsolvedPieces.length);
                        const piece = unsolvedPieces[randomIndex];
                        
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        
                        piece.style.left = `${correctX}px`;
                        piece.style.top = `${correctY}px`;
                        piece.classList.add('correct');
                        
                        if (!piece.dataset.counted) {
                            piece.dataset.counted = 'true';
                            correctPieces++;
                            
                            if (correctPieces === pieceCount) {
                                // Puzzle complete
                                setTimeout(() => {
                                    puzzleComplete.classList.add('active');
                                }, 500);
                            }
                        }
                    }
                });
                
                // Next puzzle button
                nextPuzzleBtn.addEventListener('click', function() {
                    puzzleComplete.classList.remove('active');
                    showPage(5); // Go to next puzzle page
                });
                
                // Initialize puzzle
                createPuzzle();
                
                // Resize handler
                window.addEventListener('resize', function() {
                    createPuzzle();
                });
            }
            
            // Puzzle Game 2 - Image Puzzle
            function setupPuzzleGame2() {
                const puzzleContainer = document.getElementById('puzzleContainer2');
                const helpBtn = document.getElementById('helpBtn2');
                const puzzleComplete = document.getElementById('puzzleComplete2');
                const nextPuzzleBtn = document.getElementById('nextPuzzleBtn2');
                
                const imageUrl = assets.puzzle2;
                const rows = 4;
                const cols = 4;
                const pieceCount = rows * cols;
                let pieces = [];
                let correctPieces = 0;
                
                // Create puzzle pieces
                function createPuzzle() {
                    puzzleContainer.innerHTML = '';
                    pieces = [];
                    correctPieces = 0;
                    
                    // Create puzzle pieces
                    for (let i = 0; i < pieceCount; i++) {
                        const piece = document.createElement('div');
                        piece.className = 'puzzle-piece';
                        piece.dataset.index = i;
                        
                        // Add border to all pieces
                        piece.style.border = '2px solid var(--metallic-gold)';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Add mini frame to each piece
                        const pieceFrame = document.createElement('div');
                        pieceFrame.className = 'puzzle-piece-frame';
                        piece.appendChild(pieceFrame);
                        
                        // Calculate position in grid
                        const row = Math.floor(i / cols);
                        const col = i % cols;
                        
                        // Set background position
                        piece.style.backgroundImage = `url(${imageUrl})`;
                        piece.style.backgroundSize = `${cols * 100}% ${rows * 100}%`;
                        piece.style.backgroundPosition = `${(col / (cols - 1)) * 100}% ${(row / (rows - 1)) * 100}%`;
                        
                        // Set size
                        const containerWidth = puzzleContainer.offsetWidth;
                        const pieceWidth = containerWidth / cols;
                        piece.style.width = `${pieceWidth}px`;
                        piece.style.height = `${pieceWidth}px`;
                        
                        // Store correct position
                        piece.dataset.correctX = col * pieceWidth;
                        piece.dataset.correctY = row * pieceWidth;
                        
                        // Set random position around the container (split left and right)
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides
                        let angle, distance;
                        if (i % 2 === 0) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                        }
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance;
                        
                        piece.style.left = `${x}px`;
                        piece.style.top = `${y}px`;
                        
                        // Make draggable with touch support
                        makeDraggable(piece);
                        
                        puzzleContainer.appendChild(piece);
                        pieces.push(piece);
                    }
                    
                    // Show full image first, then scramble after 1 second
                    setTimeout(() => {
                        scramblePuzzle();
                    }, 1000);
                }
                
                // Scramble puzzle pieces
                function scramblePuzzle() {
                    pieces.forEach(piece => {
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides
                        let angle, distance;
                        if (Math.random() > 0.5) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                        }
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance;
                        
                        piece.style.left = `${x}px`;
                        piece.style.top = `${y}px`;
                        piece.classList.remove('correct');
                    });
                }
                
                // Make puzzle pieces draggable with touch support
                function makeDraggable(piece) {
                    let offsetX, offsetY;
                    let isDragging = false;
                    
                    // Mouse events
                    piece.addEventListener('mousedown', startDrag);
                    
                    // Touch events
                    piece.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        const mouseEvent = new MouseEvent('mousedown', {
                            clientX: touch.clientX,
                            clientY: touch.clientY
                        });
                        piece.dispatchEvent(mouseEvent);
                    }, {passive: false});
                    
                    function startDrag(e) {
                        e.preventDefault();
                        isDragging = true;
                        
                        // Get initial position
                        const rect = piece.getBoundingClientRect();
                        if (e.type === 'mousedown') {
                            offsetX = e.clientX - rect.left;
                            offsetY = e.clientY - rect.top;
                        } else {
                            offsetX = e.touches[0].clientX - rect.left;
                            offsetY = e.touches[0].clientY - rect.top;
                        }
                        
                        // Bring to front
                        piece.style.zIndex = '20';
                        piece.style.transform = 'scale(1.1)';
                        piece.style.boxShadow = '0 0 20px var(--pure-gold)';
                        
                        // Mouse move
                        document.addEventListener('mousemove', drag);
                        
                        // Touch move
                        document.addEventListener('touchmove', function(e) {
                            e.preventDefault();
                            const touch = e.touches[0];
                            const mouseEvent = new MouseEvent('mousemove', {
                                clientX: touch.clientX,
                                clientY: touch.clientY
                            });
                            drag(mouseEvent);
                        }, {passive: false});
                        
                        // Mouse up
                        document.addEventListener('mouseup', endDrag);
                        
                        // Touch end
                        document.addEventListener('touchend', function(e) {
                            const mouseEvent = new MouseEvent('mouseup');
                            endDrag(mouseEvent);
                        });
                    }
                    
                    function drag(e) {
                        if (!isDragging) return;
                        
                        const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                        const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                        
                        piece.style.left = `${clientX - offsetX}px`;
                        piece.style.top = `${clientY - offsetY}px`;
                    }
                    
                    function endDrag() {
                        if (!isDragging) return;
                        isDragging = false;
                        
                        // Reset appearance
                        piece.style.transform = '';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Check if piece is in correct position
                        const pieceRect = piece.getBoundingClientRect();
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        
                        const pieceCenterX = pieceRect.left + pieceRect.width / 2 - containerRect.left;
                        const pieceCenterY = pieceRect.top + pieceRect.height / 2 - containerRect.top;
                        
                        const distance = Math.sqrt(
                            Math.pow(pieceCenterX - correctX, 2) + 
                            Math.pow(pieceCenterY - correctY, 2)
                        );
                        
                        if (distance < 30) { // Close enough to be correct
                            piece.style.left = `${correctX}px`;
                            piece.style.top = `${correctY}px`;
                            piece.classList.add('correct');
                            piece.style.zIndex = '15';
                            
                            // Add particle effect
                            createParticles(pieceRect.left + pieceRect.width/2, pieceRect.top + pieceRect.height/2);
                            
                            if (!piece.dataset.counted) {
                                piece.dataset.counted = 'true';
                                correctPieces++;
                                
                                if (correctPieces === pieceCount) {
                                    // Puzzle complete
                                    setTimeout(() => {
                                        puzzleComplete.classList.add('active');
                                        createEnhancedConfetti();
                                    }, 500);
                                }
                            }
                        }
                        
                        document.removeEventListener('mousemove', drag);
                        document.removeEventListener('touchmove', drag);
                        document.removeEventListener('mouseup', endDrag);
                        document.removeEventListener('touchend', endDrag);
                    }
                }
                
                // Create particles effect
                function createParticles(x, y) {
                    const colors = ['var(--pure-gold)', 'var(--ruby-red)', 'var(--emerald-green)', 'var(--sapphire-blue)'];
                    
                    for (let i = 0; i < 15; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.position = 'fixed';
                        particle.style.width = '8px';
                        particle.style.height = '8px';
                        particle.style.borderRadius = '50%';
                        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        particle.style.left = `${x}px`;
                        particle.style.top = `${y}px`;
                        particle.style.pointerEvents = 'none';
                        particle.style.zIndex = '30';
                        
                        document.body.appendChild(particle);
                        
                        // Animate
                        const angle = Math.random() * Math.PI * 2;
                        const distance = 20 + Math.random() * 50;
                        const duration = 0.5 + Math.random() * 0.5;
                        
                        const animation = particle.animate([
                            { 
                                transform: 'translate(0, 0) scale(1)',
                                opacity: 1 
                            },
                            { 
                                transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(0)`,
                                opacity: 0 
                            }
                        ], {
                            duration: duration * 1000,
                            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                        });
                        
                        animation.onfinish = () => particle.remove();
                    }
                }
                
                // Help button - solve one piece
                helpBtn.addEventListener('click', function() {
                    const unsolvedPieces = pieces.filter(p => !p.classList.contains('correct'));
                    if (unsolvedPieces.length > 0) {
                        const randomIndex = Math.floor(Math.random() * unsolvedPieces.length);
                        const piece = unsolvedPieces[randomIndex];
                        
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        
                        piece.style.left = `${correctX}px`;
                        piece.style.top = `${correctY}px`;
                        piece.classList.add('correct');
                        
                        if (!piece.dataset.counted) {
                            piece.dataset.counted = 'true';
                            correctPieces++;
                            
                            if (correctPieces === pieceCount) {
                                // Puzzle complete
                                setTimeout(() => {
                                    puzzleComplete.classList.add('active');
                                }, 500);
                            }
                        }
                    }
                });
                
                // Next puzzle button
                nextPuzzleBtn.addEventListener('click', function() {
                    puzzleComplete.classList.remove('active');
                    showPage(6); // Go to next puzzle page
                });
                
                // Initialize puzzle
                createPuzzle();
                
                // Resize handler
                window.addEventListener('resize', function() {
                    createPuzzle();
                });
            }
            
            // Puzzle Game 3 - Image Puzzle (New Puzzle)
            function setupPuzzleGame3() {
                const puzzleContainer = document.getElementById('puzzleContainer3');
                const helpBtn = document.getElementById('helpBtn3');
                const puzzleComplete = document.getElementById('puzzleComplete3');
                const nextPuzzleBtn = document.getElementById('nextPuzzleBtn3');
                
                const imageUrl = assets.puzzle3;
                const rows = 4;
                const cols = 4;
                const pieceCount = rows * cols;
                let pieces = [];
                let correctPieces = 0;
                
                // Create puzzle pieces
                function createPuzzle() {
                    puzzleContainer.innerHTML = '';
                    pieces = [];
                    correctPieces = 0;
                    
                    // Create puzzle pieces
                    for (let i = 0; i < pieceCount; i++) {
                        const piece = document.createElement('div');
                        piece.className = 'puzzle-piece';
                        piece.dataset.index = i;
                        
                        // Add border to all pieces
                        piece.style.border = '2px solid var(--metallic-gold)';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Add mini frame to each piece
                        const pieceFrame = document.createElement('div');
                        pieceFrame.className = 'puzzle-piece-frame';
                        piece.appendChild(pieceFrame);
                        
                        // Calculate position in grid
                        const row = Math.floor(i / cols);
                        const col = i % cols;
                        
                        // Set background position
                        piece.style.backgroundImage = `url(${imageUrl})`;
                        piece.style.backgroundSize = `${cols * 100}% ${rows * 100}%`;
                        piece.style.backgroundPosition = `${(col / (cols - 1)) * 100}% ${(row / (rows - 1)) * 100}%`;
                        
                        // Set size
                        const containerWidth = puzzleContainer.offsetWidth;
                        const pieceWidth = containerWidth / cols;
                        piece.style.width = `${pieceWidth}px`;
                        piece.style.height = `${pieceWidth}px`;
                        
                        // Store correct position
                        piece.dataset.correctX = col * pieceWidth;
                        piece.dataset.correctY = row * pieceWidth;
                        
                        // Set random position around the container (split left and right)
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides
                        let angle, distance;
                        if (i % 2 === 0) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                        }
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance;
                        
                        piece.style.left = `${x}px`;
                        piece.style.top = `${y}px`;
                        
                        // Make draggable with touch support
                        makeDraggable(piece);
                        
                        puzzleContainer.appendChild(piece);
                        pieces.push(piece);
                    }
                    
                    // Show full image first, then scatter after 2.5 seconds
                    setTimeout(() => {
                        scatterPieces();
                    }, 2500);
                }
                
                // Scatter puzzle pieces with animation
                function scatterPieces() {
                    pieces.forEach(piece => {
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        const containerCenterX = containerRect.left + containerRect.width / 2;
                        const containerCenterY = containerRect.top + containerRect.height / 2;
                        
                        // Split pieces to left and right sides in two rows
                        let angle, distance, row;
                        if (Math.random() > 0.5) {
                            // Left side
                            angle = Math.random() * Math.PI/2 + Math.PI/4; // 45-135 degrees
                            distance = 100 + Math.random() * 150;
                            row = Math.random() > 0.5 ? 1 : 2; // Random row (1 or 2)
                        } else {
                            // Right side
                            angle = Math.random() * Math.PI/2 + Math.PI*5/4; // 225-315 degrees
                            distance = 100 + Math.random() * 150;
                            row = Math.random() > 0.5 ? 1 : 2; // Random row (1 or 2)
                        }
                        
                        // Adjust y position based on row
                        const yOffset = row === 1 ? -50 : 50;
                        
                        const x = containerCenterX + Math.cos(angle) * distance;
                        const y = containerCenterY + Math.sin(angle) * distance + yOffset;
                        
                        // Set CSS variables for animation
                        piece.style.setProperty('--end-x', `${x - parseFloat(piece.style.left)}px`);
                        piece.style.setProperty('--end-y', `${y - parseFloat(piece.style.top)}px`);
                        piece.style.setProperty('--rotate', `${Math.random() * 360}deg`);
                        
                        // Apply animation
                        piece.style.animation = `scatterPieces 0.8s ease-out forwards`;
                        
                        // Update final position after animation
                        setTimeout(() => {
                            piece.style.left = `${x}px`;
                            piece.style.top = `${y}px`;
                            piece.style.animation = '';
                            piece.classList.remove('correct');
                        }, 800);
                    });
                }
                
                // Make puzzle pieces draggable with touch support
                function makeDraggable(piece) {
                    let offsetX, offsetY;
                    let isDragging = false;
                    
                    // Mouse events
                    piece.addEventListener('mousedown', startDrag);
                    
                    // Touch events
                    piece.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        const mouseEvent = new MouseEvent('mousedown', {
                            clientX: touch.clientX,
                            clientY: touch.clientY
                        });
                        piece.dispatchEvent(mouseEvent);
                    }, {passive: false});
                    
                    function startDrag(e) {
                        e.preventDefault();
                        isDragging = true;
                        
                        // Get initial position
                        const rect = piece.getBoundingClientRect();
                        if (e.type === 'mousedown') {
                            offsetX = e.clientX - rect.left;
                            offsetY = e.clientY - rect.top;
                        } else {
                            offsetX = e.touches[0].clientX - rect.left;
                            offsetY = e.touches[0].clientY - rect.top;
                        }
                        
                        // Bring to front
                        piece.style.zIndex = '20';
                        piece.style.transform = 'scale(1.1)';
                        piece.style.boxShadow = '0 0 20px var(--pure-gold)';
                        
                        // Mouse move
                        document.addEventListener('mousemove', drag);
                        
                        // Touch move
                        document.addEventListener('touchmove', function(e) {
                            e.preventDefault();
                            const touch = e.touches[0];
                            const mouseEvent = new MouseEvent('mousemove', {
                                clientX: touch.clientX,
                                clientY: touch.clientY
                            });
                            drag(mouseEvent);
                        }, {passive: false});
                        
                        // Mouse up
                        document.addEventListener('mouseup', endDrag);
                        
                        // Touch end
                        document.addEventListener('touchend', function(e) {
                            const mouseEvent = new MouseEvent('mouseup');
                            endDrag(mouseEvent);
                        });
                    }
                    
                    function drag(e) {
                        if (!isDragging) return;
                        
                        const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                        const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                        
                        piece.style.left = `${clientX - offsetX}px`;
                        piece.style.top = `${clientY - offsetY}px`;
                    }
                    
                    function endDrag() {
                        if (!isDragging) return;
                        isDragging = false;
                        
                        // Reset appearance
                        piece.style.transform = '';
                        piece.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.5)';
                        
                        // Check if piece is in correct position
                        const pieceRect = piece.getBoundingClientRect();
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        const containerRect = puzzleContainer.getBoundingClientRect();
                        
                        const pieceCenterX = pieceRect.left + pieceRect.width / 2 - containerRect.left;
                        const pieceCenterY = pieceRect.top + pieceRect.height / 2 - containerRect.top;
                        
                        const distance = Math.sqrt(
                            Math.pow(pieceCenterX - correctX, 2) + 
                            Math.pow(pieceCenterY - correctY, 2)
                        );
                        
                        if (distance < 30) { // Close enough to be correct
                            piece.style.left = `${correctX}px`;
                            piece.style.top = `${correctY}px`;
                            piece.classList.add('correct');
                            piece.style.zIndex = '15';
                            
                            // Add particle effect
                            createParticles(pieceRect.left + pieceRect.width/2, pieceRect.top + pieceRect.height/2);
                            
                            if (!piece.dataset.counted) {
                                piece.dataset.counted = 'true';
                                correctPieces++;
                                
                                if (correctPieces === pieceCount) {
                                    // Puzzle complete
                                    setTimeout(() => {
                                        puzzleComplete.classList.add('active');
                                        createEnhancedConfetti();
                                    }, 500);
                                }
                            }
                        }
                        
                        document.removeEventListener('mousemove', drag);
                        document.removeEventListener('touchmove', drag);
                        document.removeEventListener('mouseup', endDrag);
                        document.removeEventListener('touchend', endDrag);
                    }
                }
                
                // Create particles effect
                function createParticles(x, y) {
                    const colors = ['var(--pure-gold)', 'var(--ruby-red)', 'var(--emerald-green)', 'var(--sapphire-blue)'];
                    
                    for (let i = 0; i < 15; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.position = 'fixed';
                        particle.style.width = '8px';
                        particle.style.height = '8px';
                        particle.style.borderRadius = '50%';
                        particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        particle.style.left = `${x}px`;
                        particle.style.top = `${y}px`;
                        particle.style.pointerEvents = 'none';
                        particle.style.zIndex = '30';
                        
                        document.body.appendChild(particle);
                        
                        // Animate
                        const angle = Math.random() * Math.PI * 2;
                        const distance = 20 + Math.random() * 50;
                        const duration = 0.5 + Math.random() * 0.5;
                        
                        const animation = particle.animate([
                            { 
                                transform: 'translate(0, 0) scale(1)',
                                opacity: 1 
                            },
                            { 
                                transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(0)`,
                                opacity: 0 
                            }
                        ], {
                            duration: duration * 1000,
                            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                        });
                        
                        animation.onfinish = () => particle.remove();
                    }
                }
                
                // Help button - solve one piece
                helpBtn.addEventListener('click', function() {
                    const unsolvedPieces = pieces.filter(p => !p.classList.contains('correct'));
                    if (unsolvedPieces.length > 0) {
                        const randomIndex = Math.floor(Math.random() * unsolvedPieces.length);
                        const piece = unsolvedPieces[randomIndex];
                        
                        const correctX = parseFloat(piece.dataset.correctX);
                        const correctY = parseFloat(piece.dataset.correctY);
                        
                        piece.style.left = `${correctX}px`;
                        piece.style.top = `${correctY}px`;
                        piece.classList.add('correct');
                        
                        if (!piece.dataset.counted) {
                            piece.dataset.counted = 'true';
                            correctPieces++;
                            
                            if (correctPieces === pieceCount) {
                                // Puzzle complete
                                setTimeout(() => {
                                    puzzleComplete.classList.add('active');
                                }, 500);
                            }
                        }
                    }
                });
                
                // Next puzzle button - remove this puzzle after word puzzle
                nextPuzzleBtn.addEventListener('click', function() {
                    puzzleComplete.classList.remove('active');
                    
                    // Remove puzzle 3 (the one after word puzzle) from the assets
                    assets.puzzle3 = '';
                    
                    showPage(7); // Go to word puzzle page
                });
                
                // Initialize puzzle
                createPuzzle();
                
                // Resize handler
                window.addEventListener('resize', function() {
                    createPuzzle();
                });
            }
            
            // Word Puzzle Game
            function setupWordPuzzle() {
                const wordDisplay = document.getElementById('wordDisplay');
                const wordLetters = document.getElementById('wordLetters');
                const wordClearBtn = document.getElementById('wordClearBtn');
                const wordHelpBtn = document.getElementById('wordHelpBtn');
                const wordPuzzleComplete = document.getElementById('wordPuzzleComplete');
                const nextWordPuzzleBtn = document.getElementById('nextWordPuzzleBtn');
                
                const targetPhrase = "HAPPY BIRTHDAY NAYRA";
                const letters = targetPhrase.replace(/\s/g, '').split('');
                let selectedLetters = [];
                let solved = false;
                
                // Shuffle array
                function shuffleArray(array) {
                    for (let i = array.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [array[i], array[j]] = [array[j], array[i]];
                    }
                    return array;
                }
                
                // Create word puzzle
                function createWordPuzzle() {
                    wordDisplay.innerHTML = '';
                    wordLetters.innerHTML = '';
                    selectedLetters = [];
                    solved = false;
                    
                    // Create letter elements
                    const shuffledLetters = shuffleArray([...letters]);
                    
                    shuffledLetters.forEach((letter, index) => {
                        const letterElement = document.createElement('div');
                        letterElement.className = 'word-puzzle-letter';
                        letterElement.textContent = letter;
                        letterElement.dataset.index = index;
                        letterElement.addEventListener('click', selectLetter);
                        wordLetters.appendChild(letterElement);
                    });
                    
                    // Create target display
                    for (let i = 0; i < targetPhrase.length; i++) {
                        const slot = document.createElement('div');
                        slot.className = 'word-puzzle-slot';
                        if (targetPhrase[i] === ' ') {
                            slot.textContent = ' ';
                            slot.style.visibility = 'hidden';
                        } else {
                            slot.textContent = '_';
                        }
                        slot.dataset.position = i;
                        wordDisplay.appendChild(slot);
                    }
                }
                
                // Select letter
                function selectLetter(e) {
                    if (solved) return;
                    
                    const letterElement = e.target;
                    const letter = letterElement.textContent;
                    
                    // Find next available slot (skip spaces)
                    let targetPosition = -1;
                    for (let i = 0; i < targetPhrase.length; i++) {
                        if (targetPhrase[i] === ' ') continue;
                        if (!selectedLetters.some(item => item.position === i)) {
                            targetPosition = i;
                            break;
                        }
                    }
                    
                    if (targetPosition === -1) return;
                    
                    // Check if letter is correct for this position
                    const isCorrect = targetPhrase[targetPosition] === letter;
                    
                    // Add to selected letters
                    selectedLetters.push({
                        letter: letter,
                        position: targetPosition,
                        element: letterElement,
                        correct: isCorrect
                    });
                    
                    // Update display
                    const displaySlots = wordDisplay.querySelectorAll('.word-puzzle-slot');
                    displaySlots[targetPosition].textContent = letter;
                    displaySlots[targetPosition].classList.add(isCorrect ? 'correct' : 'incorrect');
                    
                    // Disable letter
                    letterElement.classList.add('used');
                    
                    // Check if puzzle is complete
                    checkCompletion();
                }
                
                // Check if puzzle is complete
                function checkCompletion() {
                    const displaySlots = wordDisplay.querySelectorAll('.word-puzzle-slot');
                    let allCorrect = true;
                    
                    for (let i = 0; i < targetPhrase.length; i++) {
                        if (targetPhrase[i] === ' ') continue;
                        
                        const slot = displaySlots[i];
                        if (slot.textContent !== targetPhrase[i]) {
                            allCorrect = false;
                            break;
                        }
                    }
                    
                    if (allCorrect) {
                        solved = true;
                        setTimeout(() => {
                            wordPuzzleComplete.classList.add('active');
                            createEnhancedConfetti();
                        }, 500);
                    }
                }
                
                // Clear button - reset selected letters
                wordClearBtn.addEventListener('click', function() {
                    if (solved) return;
                    
                    // Reset display slots
                    const displaySlots = wordDisplay.querySelectorAll('.word-puzzle-slot');
                    displaySlots.forEach(slot => {
                        if (slot.textContent !== ' ') {
                            slot.textContent = '_';
                            slot.classList.remove('correct', 'incorrect');
                        }
                    });
                    
                    // Reset letters
                    const letterElements = wordLetters.querySelectorAll('.word-puzzle-letter');
                    letterElements.forEach(el => {
                        el.classList.remove('used');
                    });
                    
                    // Clear selected letters
                    selectedLetters = [];
                });
                
                // Help button - reveal one correct letter
                wordHelpBtn.addEventListener('click', function() {
                    if (solved) return;
                    
                    // Find first incorrect or empty position
                    const displaySlots = wordDisplay.querySelectorAll('.word-puzzle-slot');
                    let helpPosition = -1;
                    
                    for (let i = 0; i < targetPhrase.length; i++) {
                        if (targetPhrase[i] === ' ') continue;
                        
                        if (displaySlots[i].textContent === '_' || 
                           displaySlots[i].textContent !== targetPhrase[i]) {
                            helpPosition = i;
                            break;
                        }
                    }
                    
                    if (helpPosition === -1) return;
                    
                    // Find the correct letter in the letters pool
                    const correctLetter = targetPhrase[helpPosition];
                    const letterElements = wordLetters.querySelectorAll('.word-puzzle-letter');
                    let letterElement = null;
                    
                    for (let i = 0; i < letterElements.length; i++) {
                        if (letterElements[i].textContent === correctLetter && 
                            !letterElements[i].classList.contains('used')) {
                            letterElement = letterElements[i];
                            break;
                        }
                    }
                    
                    if (letterElement) {
                        // Simulate click on the correct letter
                        const event = new MouseEvent('click', {
                            view: window,
                            bubbles: true,
                            cancelable: true
                        });
                        letterElement.dispatchEvent(event);
                    }
                });
                
                // Next puzzle button
                nextWordPuzzleBtn.addEventListener('click', function() {
                    wordPuzzleComplete.classList.remove('active');
                    showPage(8); // Go to card creator page
                });
                
                // Initialize word puzzle
                createWordPuzzle();
            }
            
            // Birthday Card Creator
            function setupCardCreator() {
                const cardPreview = document.getElementById('cardPreview');
                const cardMessage = document.getElementById('cardMessage');
                const clearCardBtn = document.getElementById('clearCardBtn');
                const finishCardBtn = document.getElementById('finishCardBtn');
                const cardFinal = document.getElementById('cardFinal');
                const cardFinalImage = document.getElementById('cardFinalImage');
                const closeCardBtn = document.getElementById('closeCardBtn');
                
                let elements = [];
                let selectedElement = null;
                
                // Card elements data
                const cardElements = {
                    balloon: {
                        src: 'https://cdn.pixabay.com/photo/2017/01/31/23/42/balloons-2028478_960_720.png',
                        width: 80,
                        height: 100
                    },
                    cake: {
                        src: 'https://cdn.pixabay.com/photo/2017/01/11/11/33/cake-1971552_960_720.png',
                        width: 100,
                        height: 80
                    },
                    gift: {
                        src: 'https://cdn.pixabay.com/photo/2017/01/31/23/36/gift-2028727_960_720.png',
                        width: 80,
                        height: 80
                    },
                    hat: {
                        src: 'https://cdn.pixabay.com/photo/2017/01/31/23/36/party-2028725_960_720.png',
                        width: 80,
                        height: 80
                    },
                    confetti: {
                        src: 'https://cdn.pixabay.com/photo/2017/01/31/23/36/confetti-2028726_960_720.png',
                        width: 100,
                        height: 100
                    }
                };
                
                // Add element buttons event listeners
                document.querySelectorAll('.card-element-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const type = this.dataset.type;
                        addElementToCard(type);
                    });
                });
                
                // Add element to card
                function addElementToCard(type) {
                    const elementData = cardElements[type];
                    const element = document.createElement('div');
                    element.className = 'card-element';
                    element.dataset.type = type;
                    
                    const img = document.createElement('img');
                    img.src = elementData.src;
                    img.style.width = `${elementData.width}px`;
                    img.style.height = `${elementData.height}px`;
                    
                    element.appendChild(img);
                    
                    // Position randomly within card
                    const cardRect = cardPreview.getBoundingClientRect();
                    const maxX = cardRect.width - elementData.width;
                    const maxY = cardRect.height - elementData.height;
                    
                    const x = Math.max(0, Math.min(maxX, Math.random() * maxX));
                    const y = Math.max(0, Math.min(maxY, Math.random() * maxY));
                    
                    element.style.left = `${x}px`;
                    element.style.top = `${y}px`;
                    element.style.width = `${elementData.width}px`;
                    element.style.height = `${elementData.height}px`;
                    
                    // Create sparkle effect
                    createSparkle(x + elementData.width/2, y + elementData.height/2);
                    
                    // Make draggable
                    makeElementDraggable(element);
                    
                    cardPreview.appendChild(element);
                    elements.push(element);
                    
                    // Select this element
                    selectElement(element);
                }
                
                // Create sparkle effect
                function createSparkle(x, y) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'card-sparkle';
                    sparkle.style.left = `${x}px`;
                    sparkle.style.top = `${y}px`;
                    
                    // Random color
                    const colors = ['var(--pure-gold)', 'var(--ruby-red)', 'var(--emerald-green)', 'var(--sapphire-blue)', 'var(--royal-purple)'];
                    sparkle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    cardPreview.appendChild(sparkle);
                    
                    // Remove after animation
                    setTimeout(() => {
                        sparkle.remove();
                    }, 800);
                }
                
                // Make element draggable
                function makeElementDraggable(element) {
                    let offsetX, offsetY;
                    let isDragging = false;
                    
                    element.addEventListener('mousedown', startDrag);
                    element.addEventListener('touchstart', startDrag);
                    
                    function startDrag(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        isDragging = true;
                        
                        // Get initial position
                        const rect = element.getBoundingClientRect();
                        if (e.type === 'mousedown') {
                            offsetX = e.clientX - rect.left;
                            offsetY = e.clientY - rect.top;
                        } else {
                            offsetX = e.touches[0].clientX - rect.left;
                            offsetY = e.touches[0].clientY - rect.top;
                        }
                        
                        // Select this element
                        selectElement(element);
                        
                        document.addEventListener('mousemove', drag);
                        document.addEventListener('touchmove', drag);
                        document.addEventListener('mouseup', endDrag);
                        document.addEventListener('touchend', endDrag);
                    }
                    
                    function drag(e) {
                        if (!isDragging) return;
                        e.preventDefault();
                        
                        const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                        const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                        
                        const cardRect = cardPreview.getBoundingClientRect();
                        const maxX = cardRect.width - element.offsetWidth;
                        const maxY = cardRect.height - element.offsetHeight;
                        
                        let x = clientX - cardRect.left - offsetX;
                        let y = clientY - cardRect.top - offsetY;
                        
                        // Constrain to card bounds
                        x = Math.max(0, Math.min(maxX, x));
                        y = Math.max(0, Math.min(maxY, y));
                        
                        element.style.left = `${x}px`;
                        element.style.top = `${y}px`;
                    }
                    
                    function endDrag() {
                        if (!isDragging) return;
                        isDragging = false;
                        
                        document.removeEventListener('mousemove', drag);
                        document.removeEventListener('touchmove', drag);
                        document.removeEventListener('mouseup', endDrag);
                        document.removeEventListener('touchend', endDrag);
                    }
                }
                
                // Select element
                function selectElement(element) {
                    // Deselect previous
                    if (selectedElement) {
                        selectedElement.classList.remove('selected');
                    }
                    
                    // Select new
                    selectedElement = element;
                    element.classList.add('selected');
                }
                
                // Clear card
                clearCardBtn.addEventListener('click', function() {
                    elements.forEach(el => el.remove());
                    elements = [];
                    selectedElement = null;
                    cardMessage.value = '';
                });
                
                // Create confetti effect
                function createConfetti() {
                    for (let i = 0; i < 50; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'card-confetti';
                        
                        // Random shape and color
                        const shapes = ['circle', 'square'];
                        const colors = ['var(--pure-gold)', 'var(--ruby-red)', 'var(--emerald-green)', 'var(--sapphire-blue)', 'var(--royal-purple)'];
                        
                        const shape = shapes[Math.floor(Math.random() * shapes.length)];
                        const color = colors[Math.floor(Math.random() * colors.length)];
                        
                        confetti.style.backgroundColor = color;
                        confetti.style.borderRadius = shape === 'circle' ? '50%' : '0';
                        
                        // Random size
                        const size = 5 + Math.random() * 10;
                        confetti.style.width = `${size}px`;
                        confetti.style.height = `${size}px`;
                        
                        // Random position
                        confetti.style.left = `${Math.random() * 100}%`;
                        confetti.style.top = `${-10 - Math.random() * 20}%`;
                        
                        // Random animation
                        const animationDuration = 2 + Math.random() * 3;
                        const animationDelay = Math.random() * 2;
                        const animationName = `confetti-fall-${Math.floor(Math.random() * 3) + 1}`;
                        
                        confetti.style.animation = `${animationName} ${animationDuration}s ease-in ${animationDelay}s forwards`;
                        
                        cardFinal.appendChild(confetti);
                        
                        // Remove after animation
                        setTimeout(() => {
                            confetti.remove();
                        }, (animationDuration + animationDelay) * 1000);
                    }
                }
                
                // Add confetti animations to style
                function addConfettiAnimations() {
                    const style = document.createElement('style');
                    style.textContent = `
                        @keyframes confetti-fall-1 {
                            0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
                            10% { opacity: 1; }
                            100% { transform: translate(${Math.random() * 100 - 50}px, 120vh) rotate(${Math.random() * 360}deg); opacity: 0; }
                        }
                        @keyframes confetti-fall-2 {
                            0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
                            10% { opacity: 1; }
                            100% { transform: translate(${Math.random() * 100 - 50}px, 120vh) rotate(${Math.random() * 360}deg); opacity: 0; }
                        }
                        @keyframes confetti-fall-3 {
                            0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
                            10% { opacity: 1; }
                            100% { transform: translate(${Math.random() * 100 - 50}px, 120vh) rotate(${Math.random() * 360}deg); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                // Finish card
                finishCardBtn.addEventListener('click', function() {
                    // Add message to card if provided
                    if (cardMessage.value.trim()) {
                        const messageElement = document.createElement('div');
                        messageElement.className = 'card-element';
                        messageElement.style.position = 'absolute';
                        messageElement.style.bottom = '20px';
                        messageElement.style.left = '0';
                        messageElement.style.width = '100%';
                        messageElement.style.textAlign = 'center';
                        messageElement.style.fontFamily = '"Playfair Display", serif';
                        messageElement.style.fontSize = '24px';
                        messageElement.style.color = '#333';
                        messageElement.style.fontWeight = 'bold';
                        messageElement.textContent = cardMessage.value;
                        
                        cardPreview.appendChild(messageElement);
                        elements.push(messageElement);
                    }
                    
                    // Convert card to image
                    html2canvas(cardPreview).then(canvas => {
                        cardFinalImage.src = canvas.toDataURL();
                        cardFinal.classList.add('active');
                        
                        // Add confetti animations
                        addConfettiAnimations();
                        
                        // Create confetti effect
                        createConfetti();
                        setInterval(createConfetti, 300);
                    });
                });
                
                // Download card when clicked
                cardFinalImage.addEventListener('click', function() {
                    const link = document.createElement('a');
                    link.download = 'nayra-birthday-card.png';
                    link.href = this.src;
                    link.click();
                });
                
                // Close card final view
                closeCardBtn.addEventListener('click', function() {
                    cardFinal.classList.remove('active');
                    showPage(9); // Go to photo page
                });
                
                // Allow clicking on card to deselect
                cardPreview.addEventListener('click', function(e) {
                    if (e.target === cardPreview) {
                        if (selectedElement) {
                            selectedElement.classList.remove('selected');
                            selectedElement = null;
                        }
                    }
                });
            }
            
            // Navigation
            let currentPage = 1;
            const totalPages = 12;
            const nextBtn = document.getElementById('nextBtn');
            
            function showPage(pageNumber) {
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                const page = document.getElementById(`page${pageNumber}`);
                if (page) {
                    page.classList.add('active');
                    currentPage = pageNumber;
                    
                    // Update next button visibility
                    if (pageNumber === totalPages) {
                        nextBtn.classList.remove('visible');
                    } else if (pageNumber > 1) {
                        nextBtn.classList.add('visible');
                    }
                    
                    // Special effects for certain pages
                    if (pageNumber >= 9 && pageNumber <= 11) { // Photo pages
                        createEnhancedConfetti();
                        const photoFrame = page.querySelector('.luxury-photo-frame');
                        if (photoFrame) {
                            photoFrame.classList.add('luxury-pop-out');
                            setTimeout(() => photoFrame.classList.remove('luxury-pop-out'), 800);
                        }
                    }
                    
                    // Initialize puzzle games when their pages are shown
                    if (pageNumber === 4) {
                        setupPuzzleGame1();
                    } else if (pageNumber === 5) {
                        setupPuzzleGame2();
                    } else if (pageNumber === 6) {
                        setupPuzzleGame3();
                    } else if (pageNumber === 7) {
                        setupWordPuzzle();
                    } else if (pageNumber === 8) {
                        setupCardCreator();
                    }
                }
            }
            
            // Start celebration
            document.getElementById('startBtn').addEventListener('click', function() {
                // Get and use name if provided
                const name = nameInput.value.trim();
                if (name) {
                    personalizedGreeting.textContent = `ULTIMATE VIP CELEBRATION, ${name}`;
                    finalGreeting.textContent = `ULTIMATE VIP CELEBRATION, ${name}`;
                }
                
                // Start animations
                createLuxuryBalloons();
                createLuxuryEmojis();
                createEnhancedConfetti();
                
                // Go to next page
                showPage(2);
                
                // Show next button after delay
                setTimeout(() => {
                    nextBtn.classList.add('visible');
                }, 3000);
                
                // Try to play music (with user interaction)
                playMusic();
            });
            
            // Next button
            nextBtn.addEventListener('click', function() {
                showPage(currentPage + 1);
            });
            
            // Restart button
            document.getElementById('restartBtn').addEventListener('click', function() {
                showPage(1);
                nextBtn.classList.remove('visible');
            });
            
            // Music control
            function playMusic() {
                bgMusic.play()
                    .then(() => {
                        isMusicPlaying = true;
                        musicControl.innerHTML = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 19V5M18 19V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        progressContainer.style.display = 'block';
                        updateProgressBar();
                    })
                    .catch(e => {
                        console.log("Autoplay prevented - user needs to interact first");
                        musicControl.innerHTML = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 20L19 4M12 20V12M5 20V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        progressContainer.style.display = 'none';
                    });
            }
            
            function updateProgressBar() {
                if (isMusicPlaying) {
                    const progress = (bgMusic.currentTime / bgMusic.duration) * 100;
                    progressBar.style.width = progress + '%';
                    requestAnimationFrame(updateProgressBar);
                }
            }
            
            musicControl.addEventListener('click', function() {
                if (isMusicPlaying) {
                    bgMusic.pause();
                    isMusicPlaying = false;
                    musicControl.innerHTML = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 20L19 4M12 20V12M5 20V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                    progressContainer.style.display = 'none';
                } else {
                    playMusic();
                }
            });
            
            // Click anywhere to progress on last page
            document.addEventListener('click', function(e) {
                if (currentPage === totalPages && !e.target.closest('.luxury-container')) {
                    showPage(1);
                    nextBtn.classList.remove('visible');
                }
            });
            
            // Start emoji animations immediately
            createLuxuryEmojis();
        });
    </script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</body>
</html>
